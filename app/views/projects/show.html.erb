<p>
  <strong id="st">Title:</strong>
  <%= @project.title %>
 <%=  @project.users.pluck(:username) %>
</p>
 
<p>
  <strong>Text:</strong>
  <%= @project.description %>
</p>
<%if (@project.users.pluck(:id).include?(current_user.id) && current_user.user_type=='Manager') %>
  <%= link_to 'Edit', edit_project_path(@project) %> |
<% end %>
<%= link_to 'Back', projects_path %>


<br/>
<br/>

<%if (@project.users.pluck(:id).include?(current_user.id) && current_user.user_type=='Manager') %>
<strong>Assign Developers to the Project</strong>

<br/><br/>

<%= form_with url: prouse_adddev_path(@project.id), local: true do |f| %>

<%= f.select(:developer_for_this_project, @developers.pluck(:username)) %>

<%= f.hidden_field :project, :value => @project.id %>

<%= f.submit "Add Developer to This Project" %>

<% end %>

<br/>

<%= form_with url: prouse_removedev_path(@project.id), remote:true, local: true do |f| %>

<%= f.select(:developer_for_this_project, @developers.pluck(:username)) %>

<%= f.hidden_field :project, :value => @project.id %>

<%= f.submit "Remove Developer to This Project" %>

<% end %>

<br/>
<strong>Assign QAs to the Project</strong>
<br/><br/>

<%= form_with url: prouse_addqa_path(@project), local: true do |f| %>

<%= f.select(:qas_for_this_project, @qas.pluck(:username)) %>

<%= f.hidden_field :project, :value => @project.id %>

<%= f.submit "Add QA to This Project" %>

<% end %>

<br/>

<%= form_with url: prouse_removeqa_path(@project.id), remote:true, local: true do |f| %>

<%= f.select(:qas_for_this_project, @qas.pluck(:username)) %>

<%= f.hidden_field :project, :value => @project.id %>

<%= f.submit "Remove QA to This Project" %>

<% end %>

<% end %>

<%if (current_user.user_type=='Developer') %>

<h2>Your Assigned Bug & Features</h2>

<table>
  <tr>
    <th>Title</th>
    <th>Description</th>
    <th>Deadline</th>
    <th>Screenshot</th>
    <th>Type</th>
    <th>Status</th>
    <th>UserId</th>
    <th colspan="2"></th>
  </tr>
<% @project.bugs.each do |bug| %>
<%if (bug.user_id==current_user.id) %>
  <tr>
      <td><%= bug.title %></td>
      <td><%= bug.description %></td>
      <td><%= bug.deadline %></td>
      <td><%= image_tag bug.screenshot, width:"50px" if bug.screenshot.attached? %></td>
      <td><%= bug.bugtype %></td>
      <td><%= bug.status %></td>
      <td><%= bug.user_id %></td>
      <%if (bug.project.users.pluck(:id).include?(current_user.id) && current_user.user_type=='QA' ) %>
      <td><%= link_to 'Edit', edit_project_bug_path(bug) %></td>
      <td><%= link_to 'Destroy', [bug.project, bug],
              method: :delete,
              data: { confirm: 'Are you sure?' } %></td>
      <% end %>
      <%if (current_user.user_type=='Developer') %>
<td>
<%= form_with url: markcomplete_path(@bug), remote:true, local: true do |f| %>

<%= f.hidden_field :pid, :value => @project.id %>
<%= f.hidden_field :bid, :value => bug.id %>

<%= f.submit "Mark it Complete" %>

<% end %>
<td>

      <% end %>
    </tr>
<% end %>

<% end %>
</table>
<% end %>




<h2>Bugs & Features</h2>

<table>
  <tr>
    <th>Title</th>
    <th>Description</th>
    <th>Deadline</th>
    <th>Screenshot</th>
    <th>Type</th>
    <th>Status</th>
    <th>UserId</th>
    <th colspan="2"></th>
  </tr>
<% @project.bugs.each do |bug| %>
<%if (bug.user_id!=current_user.id) %>
  <tr>
      <td><%= bug.title %></td>
      <td><%= bug.description %></td>
      <td><%= bug.deadline %></td>
      <td><%= image_tag bug.screenshot, width:"50px" if bug.screenshot.attached? %></td>
      <td><%= bug.bugtype %></td>
      <td><%= bug.status %></td>
      <td><%= bug.user_id %></td>
      <%if (bug.project.users.pluck(:id).include?(current_user.id) && current_user.user_type=='QA' ) %>
      <td><%= link_to 'Edit', edit_project_bug_path(bug) %></td>
      <td><%= link_to 'Destroy', [bug.project, bug],
              method: :delete,
              data: { confirm: 'Are you sure?' } %></td>
      <% end %>
      <%if (current_user.user_type=='Developer') %>
<td>
<%= form_with url: assign_path(@bug), remote:true, local: true do |f| %>

<%= f.hidden_field :pid, :value => @project.id %>
<%= f.hidden_field :bid, :value => bug.id %>

<%= f.submit "Assign Bug To Yourself" %>

<% end %>
<td>

      <% end %>
    </tr>
<% end %>

<% end %>
</table>
<%if (current_user.user_type=='QA') %>
<%= link_to 'Add New Bug', new_project_bug_path(@project) %>
<% end %>
