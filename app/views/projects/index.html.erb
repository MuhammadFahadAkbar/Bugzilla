<%= render "shared/navigationbar" %>

<br />

<div style="width: 95%; margin:auto;">

  <h1>Your Projects</h1>
  <br />
  <table class="table table-bordered table-hover" >
    <thead class="thead-dark" style="background-color:#dedede; ">
     <tr style="height: 50px;">
      <th style="vertical-align: middle;">Title</th>
      <th style="vertical-align: middle;">Description</th>
      <th style="vertical-align: middle;">Show</th>
      <%if ( current_user.user_type=='Manager') %>
      <th style="vertical-align: middle;">Edit</th>
      <th style="vertical-align: middle;">Delete</th>
      <% end %>
    </tr>
  </thead>
  <tbody>
   <% current_user.projects.each do |project| %>
   <tr style="height: 50px;">
    <td style="vertical-align: middle;"><%= project.title %></td>
    <td style="vertical-align: middle;"><%= project.description%></td>
    <td style="vertical-align: middle;"><%= link_to 'Show', project_path(project) %></td>
    <%if ( current_user.user_type=='Manager') %>
    <td style="vertical-align: middle;"><%= link_to 'Edit', edit_project_path(project) %></td>
    <td style="vertical-align: middle;"><%= link_to 'Delete', project_path(project),
    method: :delete,
    data: { confirm: 'Are you sure?' } %></td>
    <% end %>
  </tr>
  <% end %>
</tbody>
</table>

<%if ( current_user.user_type=='Manager') %>
<%= link_to 'Create New Project', new_project_path , {:style=>'width:15%;', :class => "btn btn-success"}%>
<% end %>
</div>

<br />

<%if ( current_user.user_type!='Developer') %>

<div style="width: 95%; margin:auto;">
  <h1>Other Projects</h1>
  <br />
  <table class="table table-bordered table-hover" >
    <thead class="thead-dark" style="background-color:#dedede;">
      <tr style="height: 50px;">
        <th style="vertical-align: middle;">Title</th>
        <th style="vertical-align: middle;">Description</th>
        <th style="vertical-align: middle;">Show</th>
      </tr>
    </thead>
    <tbody>
      <% @projects.each do |project| %>
      <% if project.users.pluck(:id).include?(current_user.id)%>
      <p></p>

      <% else %>
      <tr style="height: 50px;">
        <td style="vertical-align: middle;"><%= project.title %></td>
        <td style="vertical-align: middle;"><%= project.description%></td>
        <td style="vertical-align: middle;"><%= link_to 'Show', project_path(project) %></td>
        <%if (current_user.id == project.users.pluck(:id))%>
        <td style="vertical-align: middle;"><%= link_to 'Edit', edit_project_path(project) %></td>
        <td style="vertical-align: middle;"><%= link_to 'Destroy', project_path(project),
        method: :delete,
        data: { confirm: 'Are you sure?' } %></td>
        <% end %>
      </tr>
      <% end %>

      <% end %>

      <% end %>
    </tbody>
  </table>

</div>
